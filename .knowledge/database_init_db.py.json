{"is_source_file": true, "format": "Python", "description": "This script initializes and migrates an SQLite database schema for a notes application. It creates necessary tables, ensures columns exist, sets up auto-update triggers, inserts initial configuration data, and writes helper files for external tools.", "external_files": ["db_connection.txt", "db_visualizer/sqlite.env"], "external_methods": ["os.path.exists", "open", "re.search", "os.path.abspath", "os.makedirs", "sqlite3.connect", "cursor.execute", "cursor.fetchall", "cursor.fetchone"], "published": ["main"], "classes": [], "methods": [{"name": "Optional[str] _parse_db_path_from_connection_file(path: str)", "description": "Parses the database file path from the connection info file if it exists.", "scope": "", "scopeKind": ""}, {"name": "str _resolve_db_path()", "description": "Determines the database file path, prioritizing connection file info.", "scope": "", "scopeKind": ""}, {"name": "bool _table_exists(cursor: sqlite3.Cursor, table_name: str)", "description": "Checks whether a specified table exists in the database.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Tuple[str,int,Optional[str]]] _get_table_columns(cursor: sqlite3.Cursor, table_name: str)", "description": "Retrieves column information for a given table.", "scope": "", "scopeKind": ""}, {"name": "None _ensure_table_with_required_columns( cursor: sqlite3.Cursor, table_name: str, create_sql: str, required_columns: List[Tuple[str, str]], )", "description": "Creates a table if it doesn't exist and adds missing columns non-destructively.", "scope": "", "scopeKind": ""}, {"name": "None _ensure_notes_updated_at_trigger(cursor: sqlite3.Cursor)", "description": "Creates a trigger to auto-update 'updated_at' on notes when modified.", "scope": "", "scopeKind": ""}, {"name": "None main()", "description": "Performs database setup, schema migration, initial data insertion, and helper file generation.", "scope": "", "scopeKind": ""}], "calls": ["os.path.exists", "open", "re.search", "os.path.abspath", "os.makedirs", "sqlite3.connect", "cursor.execute", "cursor.fetchall", "cursor.fetchone", "conn.close"], "search-terms": ["init_db.py", "SQLite database initialization", "schema migration", "notes table", "auto-updating timestamps", "connection file parsing", "initial data insertion"], "state": 2, "file_id": 1, "knowledge_revision": 20, "git_revision": "db428a60dadb390e86b45558d827e01699fc0946", "revision_history": [{"16": "df3e2718c6961d174754753fa8ab5c0a0245f55c"}, {"20": "db428a60dadb390e86b45558d827e01699fc0946"}], "ctags": [{"_type": "tag", "name": "DB_NAME", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^DB_NAME = \"myapp.db\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DB_PASSWORD", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^DB_PASSWORD = \"kaviadefaultpassword\"  # Not used for SQLite, but kept for consistency$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DB_PORT", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^DB_PORT = \"5000\"  # Not used for SQLite, but kept for consistency$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "DB_USER", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^DB_USER = \"kaviasqlite\"  # Not used for SQLite, but kept for consistency$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_ensure_notes_updated_at_trigger", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def _ensure_notes_updated_at_trigger(cursor: sqlite3.Cursor) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(cursor: sqlite3.Cursor)"}, {"_type": "tag", "name": "_ensure_table_with_required_columns", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def _ensure_table_with_required_columns($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( cursor: sqlite3.Cursor, table_name: str, create_sql: str, required_columns: List[Tuple[str, str]], )"}, {"_type": "tag", "name": "_get_table_columns", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def _get_table_columns(cursor: sqlite3.Cursor, table_name: str) -> Dict[str, Tuple[str, int, Opt/", "language": "Python", "typeref": "typename:Dict[str,Tuple[str,int,Optional[str]]]", "kind": "function", "signature": "(cursor: sqlite3.Cursor, table_name: str)"}, {"_type": "tag", "name": "_parse_db_path_from_connection_file", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def _parse_db_path_from_connection_file(path: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(path: str)"}, {"_type": "tag", "name": "_resolve_db_path", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def _resolve_db_path() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_table_exists", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def _table_exists(cursor: sqlite3.Cursor, table_name: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(cursor: sqlite3.Cursor, table_name: str)"}, {"_type": "tag", "name": "main", "path": "/home/kavia/workspace/code-generation/simple-notes-app-312508-312525/database/init_db.py", "pattern": "/^def main() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}], "hash": "f513b8f0aa01d10b36fbdb0698a3bdc3", "format-version": 4, "code-base-name": "database", "filename": "database/init_db.py", "fields": [{"name": "DB_NAME = \"myapp.db\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_PASSWORD = \"kaviadefaultpassword\"  # Not used for SQLite, but kept for consistency", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_PORT = \"5000\"  # Not used for SQLite, but kept for consistency", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DB_USER = \"kaviasqlite\"  # Not used for SQLite, but kept for consistency", "scope": "", "scopeKind": "", "description": "unavailable"}]}